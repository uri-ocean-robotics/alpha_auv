<?xml version="1.0"?>
<launch>

    <arg name="robot_name" default="alpha"/>

    <arg name="is_sim" default="false"/>

    <node name="alpha_localization_local" pkg="robot_localization" type="ekf_localization_node" output="screen">
        <rosparam command="load" file="$(find alpha_localization)/config/robot_localization_local.yaml"/>
        <param name="base_link_frame" type="string" value="$(arg robot_name)/base_link"/>
        <param name="odom_frame" type="string" value="$(arg robot_name)/odom"/>
        <param name="world_frame" type="string" value="$(arg robot_name)/odom"/>
        <remap from="odometry/filtered" to="odometry/filtered/local"/>
        <remap from="accel/filtered" to="accel/filtered/local"/>

        <param name="imu0_remove_gravitational_acceleration" value="$(eval not arg('is_sim'))"/>
    </node>

    <group if="$(arg is_sim)">
        <node name="imu_transformer" pkg="imu_transformer" type="imu_transformer_node" output="screen">
            <remap from="imu_in/data" to="imu/stonefish/data"/>
            <remap from="imu_out/data" to="imu/data"/>
            <param name="target_frame" value="$(arg robot_name)/base_link"/>
        </node>

        <node name="alpha_pressure_to_depth" pkg="alpha_localization" type="pressure_to_depth_node" output="screen">
            <param name="frame_id" value="$(arg robot_name)/odom"/>
        </node>
    </group>

    <node name="alpha_depth_filter" pkg="alpha_localization" type="depth_filter_node" output="screen">
        <param name="frame_id" value="$(arg robot_name)/odom"/>
    </node>

</launch>